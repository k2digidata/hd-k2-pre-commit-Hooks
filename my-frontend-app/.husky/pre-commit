#!/bin/sh
set -euo pipefail

# Show what's going on
echo "ğŸ” Running pre-commit checks..."

# Get staged JS/TS files
TS_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx|js|jsx)$' || true)

if [ -z "$TS_FILES" ]; then
  echo "âœ… No JS/TS files to check."
  exit 0
fi

echo "ğŸ§¼ Running Prettier..."
npx prettier --check $TS_FILES --ignore-unknown || {
  echo "âŒ Prettier check failed. Run 'npx prettier --write <files>' to fix."
  exit 1
}

echo "ğŸ” Running ESLint..."
npx eslint $TS_FILES || {
  echo "âŒ ESLint failed."
  exit 1
}

echo "ğŸ” Running TypeScript..."
npx tsc -b --noEmit || {
  echo "âŒ TypeScript check failed."
  exit 1
}

echo "âœ… All checks passed."
exit 0
